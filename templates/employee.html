{% extends "base.html" %}

{% block title %}Submit Report - PSA Report Tool{% endblock %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <a href="{{ url_for('index') }}" class="back-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            Back to Home
        </a>
        <h1 class="page-title">Submit Daily Report</h1>
        <p class="page-subtitle">Enter your sales performance data for today</p>
    </div>

    <div class="form-container">
        <form id="reportForm" method="POST" action="{{ url_for('employee') }}">

            <!-- Section: Basic Information -->
            <div class="form-section">
                <h3 class="form-section-title">üìã Basic Information</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="employee_name" class="form-label">
                            Employee Name <span class="required">*</span>
                        </label>
                        <input type="text" class="form-control" id="employee_name" name="employee_name"
                            placeholder="Enter your full name" required>
                    </div>

                    <div class="form-group">
                        <label for="brand" class="form-label">
                            Brand <span class="required">*</span>
                        </label>
                        <input type="text" class="form-control" id="brand" name="brand" placeholder="e.g., ChicAddOns"
                            required>
                    </div>

                    <div class="form-group">
                        <label for="current_balance" class="form-label">
                            Current Balance ($) <span class="required">*</span>
                        </label>
                        <input type="number" class="form-control" id="current_balance" name="current_balance"
                            placeholder="0.00" step="0.01" required>
                    </div>
                </div>
            </div>

            <!-- Section: Orders & Reviews -->
            <div class="form-section">
                <h3 class="form-section-title">üì¶ Orders & Reviews</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="new_orders" class="form-label">
                            New Orders
                        </label>
                        <input type="number" class="form-control" id="new_orders" name="new_orders" placeholder="0"
                            min="0">
                    </div>

                    <div class="form-group">
                        <label for="vine_total_orders" class="form-label">
                            Vine (Total Orders)
                        </label>
                        <input type="number" class="form-control" id="vine_total_orders" name="vine_total_orders"
                            placeholder="0" min="0">
                    </div>

                    <div class="form-group">
                        <label for="current_inventory" class="form-label">
                            Current Inventory
                        </label>
                        <input type="number" class="form-control" id="current_inventory" name="current_inventory"
                            placeholder="0" min="0">
                    </div>

                    <div class="form-group">
                        <label for="new_reviews" class="form-label">
                            New Reviews
                        </label>
                        <input type="number" class="form-control" id="new_reviews" name="new_reviews" placeholder="0"
                            min="0">
                    </div>

                    <div class="form-group">
                        <label for="average_rating" class="form-label">
                            Average Rating (on listing)
                        </label>
                        <input type="number" class="form-control" id="average_rating" name="average_rating"
                            placeholder="0.0" step="0.1" min="0" max="5">
                    </div>
                </div>
            </div>

            <!-- Section: Rankings -->
            <div class="form-section">
                <h3 class="form-section-title">üìä Rankings</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="main_niche_ranking" class="form-label">
                            Main Niche Ranking
                        </label>
                        <input type="number" class="form-control" id="main_niche_ranking" name="main_niche_ranking"
                            placeholder="0" min="0">
                    </div>

                    <div class="form-group">
                        <label for="sub_niche_ranking" class="form-label">
                            Sub Niche Ranking
                        </label>
                        <input type="number" class="form-control" id="sub_niche_ranking" name="sub_niche_ranking"
                            placeholder="0" min="0">
                    </div>
                </div>
            </div>

            <!-- Section: Advertising -->
            <div class="form-section">
                <h3 class="form-section-title">üì¢ Advertising</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="ads_spend_total" class="form-label">
                            Ads Spend Total ($)
                        </label>
                        <input type="number" class="form-control" id="ads_spend_total" name="ads_spend_total"
                            placeholder="0.00" step="0.01" min="0">
                    </div>

                    <div class="form-group">
                        <label for="ads_sales_total" class="form-label">
                            Ads Sales Total ($)
                        </label>
                        <input type="number" class="form-control" id="ads_sales_total" name="ads_sales_total"
                            placeholder="0.00" step="0.01" min="0">
                    </div>

                    <div class="form-group">
                        <label for="acos" class="form-label">
                            ACOS (%)
                        </label>
                        <input type="number" class="form-control" id="acos" name="acos" placeholder="0.00" step="0.01"
                            min="0">
                    </div>

                    <div class="form-group">
                        <label for="impressions" class="form-label">
                            Impressions
                        </label>
                        <input type="number" class="form-control" id="impressions" name="impressions" placeholder="0"
                            min="0">
                    </div>
                </div>
            </div>

            <!-- Section: Account Status -->
            <div class="form-section">
                <h3 class="form-section-title">üè¶ Account Status</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="account_status_us" class="form-label">
                            Account Status (US) <span class="required">*</span>
                        </label>
                        <select class="form-control form-select" id="account_status_us" name="account_status_us"
                            required>
                            <option value="Healthy">Healthy</option>
                            <option value="Unhealthy">Unhealthy</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="account_status_mexico" class="form-label">
                            Account Status (Mexico) <span class="required">*</span>
                        </label>
                        <select class="form-control form-select" id="account_status_mexico" name="account_status_mexico"
                            required>
                            <option value="Healthy">Healthy</option>
                            <option value="Unhealthy">Unhealthy</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="account_status_canada" class="form-label">
                            Account Status (Canada) <span class="required">*</span>
                        </label>
                        <select class="form-control form-select" id="account_status_canada" name="account_status_canada"
                            required>
                            <option value="Healthy">Healthy</option>
                            <option value="Unhealthy">Unhealthy</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Section: Store Status -->
            <div class="form-section">
                <h3 class="form-section-title">üè™ Store Status</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="store_status_us" class="form-label">
                            Store Status (US) <span class="required">*</span>
                        </label>
                        <select class="form-control form-select" id="store_status_us" name="store_status_us" required>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="store_status_mexico" class="form-label">
                            Store Status (Mexico) <span class="required">*</span>
                        </label>
                        <select class="form-control form-select" id="store_status_mexico" name="store_status_mexico"
                            required>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="store_status_canada" class="form-label">
                            Store Status (Canada) <span class="required">*</span>
                        </label>
                        <select class="form-control form-select" id="store_status_canada" name="store_status_canada"
                            required>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-primary btn-submit" onclick="confirmSubmit()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                        <polyline points="17 21 17 13 7 13 7 21" />
                        <polyline points="7 3 7 8 15 8" />
                    </svg>
                    Save Report
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Confirmation Modal -->
<div class="modal-overlay" id="confirmModal">
    <div class="modal-content">
        <div class="modal-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <circle cx="12" cy="12" r="10" />
                <path d="M12 16v-4M12 8h.01" />
            </svg>
        </div>
        <h3 class="modal-title">Confirm Submission</h3>
        <p class="modal-message">Are you sure you want to save this report?</p>
        <div class="modal-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal()">No, Cancel</button>
            <button type="button" class="btn btn-primary" onclick="submitForm()">Yes, Save</button>
        </div>
    </div>
</div>

<style>
    .form-section {
        margin-bottom: 2rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid var(--border-color);
    }

    .form-section:last-of-type {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }

    .form-section-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 1.25rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    function confirmSubmit() {
        // Validate required fields first
        const form = document.getElementById('reportForm');
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        // Show confirmation modal
        document.getElementById('confirmModal').classList.add('active');
    }

    function closeModal() {
        document.getElementById('confirmModal').classList.remove('active');
    }

    function submitForm() {
        document.getElementById('reportForm').submit();
    }

    // Close modal on escape key
    document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') {
            closeModal();
        }
    });

    // Close modal on overlay click
    document.getElementById('confirmModal').addEventListener('click', function (e) {
        if (e.target === this) {
            closeModal();
        }
    });
</script>
{% endblock %}